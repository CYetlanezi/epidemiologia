for (k in seq_along(days)){
fit<-lm(log(acumulado)~dia, data=subset(data, dia<=days[k]))
slope[k]<-coef(summary(fit))[2,1]
slope.se[k]<-coef(summary(fit))[2,2]
R0.hat<-slope*2.5+1
R0.se<-slope.se*2.5
}
plot(slope~days,type="o")
plot(slope.se~days,type="o")
#Instalar las librerias necesarias y cargarlas
instalar <- function(paquete) {
if (!require(paquete,character.only = TRUE,
quietly = TRUE,
warn.conflicts = FALSE)){
install.packages(as.character(paquete),
dependecies = TRUE,
repos = "http://cran.us.r-project.org")
library(paquete,
character.only = TRUE,
quietly = TRUE,
warn.conflicts = FALSE)
}
}
libs <- c( 'readr', 'R0')
lapply(libs, instalar)
data<-read.csv("prueba.csv", header=TRUE)
names(data)<-c("fecha","acumulado","individual")
head(data)
plot(acumulado~fecha,data,type='b',bty='l',
main='Brote de Covid-19 en ___',
xlab='día',ylab='Casos de Covid-19')
plot(log(acumulado)~fecha,data,type='b',log='y',bty='l',main='Gráfica semilog de datos acumulados de brote de covid-19 en ___',
xlab='día',ylab='Casos de Covid-19')
d<-fechasquetomar
days<-2:30
slope<-numeric(length=length(days))
slope.se<-numeric(length=length(days))
for (k in seq_along(days)){
fit<-lm(log(acumulado)~fecha, data=subset(data, fecha<=days[k]))
slope[k]<-coef(summary(fit))[2,1]
slope.se[k]<-coef(summary(fit))[2,2]
R0.hat<-slope*2.5+1
R0.se<-slope.se*2.5
}
plot(slope~days,type="o")
plot(slope.se~days,type="o")
plot(range(days),
range(c(R0.hat-2*R0.se,R0.hat+2*R0.se),na.rm=T),
type='n',bty='l',
xlab="length of initial phase (da)",
ylab= expression("estimated" ~ R[0])
)
lines(R0.hat~days, type='o',lwd=2)
lines(R0.hat+2*R0.se~days,type='l')
lines(R0.hat-2*R0.se~days,type='l')
epid=data$individual
GT.covid<-generation.time("weibull",c(3.95,1))
sensitivity.analysis(epid, GT.covid, begin=1,end=31, est.method="EG", sa.type="time")
res.R<-estimate.R(epid,GT=GT.covid,methods=c("EG"))
(EG<-est.R0.EG(epid,GT.covid,begin=1,end=31,nsim=1000))
plotfit(res.R)
gamma<-1/3.95 #1/gamma es el tiempo promedio de infección que para el covid-19 es 3.95 días
m<-slope
mu<-1/(70*365) #1/mu es el tiempo promedio de vida
r0<-m/(mu+gamma)+1
r0
#Instalar las librerias necesarias y cargarlas
instalar <- function(paquete) {
if (!require(paquete,character.only = TRUE,
quietly = TRUE,
warn.conflicts = FALSE)){
install.packages(as.character(paquete),
dependecies = TRUE,
repos = "http://cran.us.r-project.org")
library(paquete,
character.only = TRUE,
quietly = TRUE,
warn.conflicts = FALSE)
}
}
libs <- c( 'readr', 'R0')
lapply(libs, instalar)
data<-read.csv("prueba.csv", header=TRUE)
names(data)<-c("fecha","acumulado","individual")
head(data)
plot(acumulado~fecha,data,type='b',bty='l',
main='Brote de Covid-19 en ___',
xlab='día',ylab='Casos de Covid-19')
plot(log(acumulado)~fecha,data,type='b',log='y',bty='l',main='Gráfica semilog de datos acumulados de brote de covid-19 en ___',
xlab='día',ylab='Casos de Covid-19')
d<-fechasquetomar
gamma<-1/3.95 #1/gamma es el tiempo promedio de infección que para el covid-19 es 3.95 días
m<-slope
mu<-1/(70*365) #1/mu es el tiempo promedio de vida
r0<-m/(mu+gamma)+1
r0
#Instalar las librerias necesarias y cargarlas
instalar <- function(paquete) {
if (!require(paquete,character.only = TRUE,
quietly = TRUE,
warn.conflicts = FALSE)){
install.packages(as.character(paquete),
dependecies = TRUE,
repos = "http://cran.us.r-project.org")
library(paquete,
character.only = TRUE,
quietly = TRUE,
warn.conflicts = FALSE)
}
}
libs <- c( 'readr', 'R0')
lapply(libs, instalar)
data<-read.csv("prueba.csv", header=TRUE)
names(data)<-c("fecha","acumulado","individual")
head(data)
plot(acumulado~fecha,data,type='b',bty='l',
main='Brote de Covid-19 en ___',
xlab='día',ylab='Casos de Covid-19')
plot(log(acumulado)~fecha,data,type='b',log='y',bty='l',main='Gráfica semilog de datos acumulados de brote de covid-19 en ___',
xlab='día',ylab='Casos de Covid-19')
d<-15
fit <- lm(log(acumulado)~fecha,data=subset(data,fecha<=d))
summary(fit)
coef(fit)
slope <- coef(fit)[2]
slope
gamma<-1/3.95 #1/gamma es el tiempo promedio de infección que para el covid-19 es 3.95 días
m<-slope
mu<-1/(70*365) #1/mu es el tiempo promedio de vida
r0<-m/(mu+gamma)+1
r0
#Instalar las librerias necesarias y cargarlas
instalar <- function(paquete) {
if (!require(paquete,character.only = TRUE,
quietly = TRUE,
warn.conflicts = FALSE)){
install.packages(as.character(paquete),
dependecies = TRUE,
repos = "http://cran.us.r-project.org")
library(paquete,
character.only = TRUE,
quietly = TRUE,
warn.conflicts = FALSE)
}
}
libs <- c( 'readr', 'R0')
lapply(libs, instalar)
data<-read.csv("prueba.csv", header=TRUE)
names(data)<-c("fecha","acumulado","individual")
head(data)
plot(acumulado~fecha,data,type='b',bty='l',
main='Brote de Covid-19 en ___',
xlab='día',ylab='Casos de Covid-19')
plot(log(acumulado)~fecha,data,type='b',log='y',bty='l',main='Gráfica semilog de datos acumulados de brote de covid-19 en ___',
xlab='día',ylab='Casos de Covid-19')
d<-15
fit <- lm(log(acumulado)~fecha,data=subset(data,fecha<=d))
summary(fit)
coef(fit)
slope <- coef(fit)[2]
slope
gamma<-1/3.95 #1/gamma es el tiempo promedio de infección que para el covid-19 es 3.95 días
m<-slope
mu<-1/(70*365) #1/mu es el tiempo promedio de vida
r0<-m/(mu+gamma)+1
r0
slope.se<-coef(summary(fit))[2,2]
slope.se
err<-2.5*slope.se
(inf<-r0-err)
(sup<-r0+err)
days<-2:30
slope<-numeric(length=length(days))
slope.se<-numeric(length=length(days))
for (k in seq_along(days)){
fit<-lm(log(acumulado)~fecha, data=subset(data, fecha<=days[k]))
slope[k]<-coef(summary(fit))[2,1]
slope.se[k]<-coef(summary(fit))[2,2]
R0.hat<-slope*2.5+1
R0.se<-slope.se*2.5
}
plot(slope~days,type="o")
plot(slope.se~days,type="o")
plot(range(days),
range(c(R0.hat-2*R0.se,R0.hat+2*R0.se),na.rm=T),
type='n',bty='l',
xlab="length of initial phase (da)",
ylab= expression("estimated" ~ R[0])
)
lines(R0.hat~days, type='o',lwd=2)
lines(R0.hat+2*R0.se~days,type='l')
lines(R0.hat-2*R0.se~days,type='l')
epid=data$individual
GT.covid<-generation.time("weibull",c(3.95,1))
sensitivity.analysis(epid, GT.covid, begin=1,end=31, est.method="EG", sa.type="time")
res.R<-estimate.R(epid,GT=GT.covid,methods=c("EG"))
(EG<-est.R0.EG(epid,GT.covid,begin=1,end=31,nsim=1000))
plotfit(res.R)
#Instalar las librerias necesarias y cargarlas
instalar <- function(paquete) {
if (!require(paquete,character.only = TRUE,
quietly = TRUE,
warn.conflicts = FALSE)){
install.packages(as.character(paquete),
dependecies = TRUE,
repos = "http://cran.us.r-project.org")
library(paquete,
character.only = TRUE,
quietly = TRUE,
warn.conflicts = FALSE)
}
}
libs <- c( 'readr', 'R0')
lapply(libs, instalar)
data<-read.csv("prueba.csv", header=TRUE)
names(data)<-c("fecha","acumulado","individual")
head(data)
plot(acumulado~fecha,data,type='b',bty='l',
main='Brote de Covid-19 en ___',
xlab='día',ylab='Casos de Covid-19')
plot(log(acumulado)~fecha,data,type='b',log='y',bty='l',main='Gráfica semilog de datos acumulados de brote de covid-19 en ___',
xlab='día',ylab='Casos de Covid-19')
d<-15
fit <- lm(log(acumulado)~fecha,data=subset(data,fecha<=d))
summary(fit)
coef(fit)
slope <- coef(fit)[2]
slope
gamma<-1/3.95 #1/gamma es el tiempo promedio de infección que para el covid-19 es 3.95 días
m<-slope
mu<-1/(70*365) #1/mu es el tiempo promedio de vida
r0<-m/(mu+gamma)+1
r0
slope.se<-coef(summary(fit))[2,2]
slope.se
err<-2.5*slope.se
(inf<-r0-err)
(sup<-r0+err)
days<-2:30
slope<-numeric(length=length(days))
slope.se<-numeric(length=length(days))
for (k in seq_along(days)){
fit<-lm(log(acumulado)~fecha, data=subset(data, fecha<=days[k]))
slope[k]<-coef(summary(fit))[2,1]
slope.se[k]<-coef(summary(fit))[2,2]
R0.hat<-slope*2.5+1
R0.se<-slope.se*2.5
}
plot(slope~days,type="o")
plot(slope.se~days,type="o")
plot(range(days),
range(c(R0.hat-2*R0.se,R0.hat+2*R0.se),na.rm=T),
type='n',bty='l',
xlab="length of initial phase (da)",
ylab= expression("estimated" ~ R[0])
)
lines(R0.hat~days, type='o',lwd=2)
lines(R0.hat+2*R0.se~days,type='l')
lines(R0.hat-2*R0.se~days,type='l')
epid=data$individual
GT.covid<-generation.time("weibull",c(3.95,1))
sensitivity.analysis(epid, GT.covid, begin=1,end=31, est.method="EG", sa.type="time")
res.R<-estimate.R(epid,GT=GT.covid,methods=c("EG"))
(EG<-est.R0.EG(epid,GT.covid,begin=1,end=31,nsim=1000))
plotfit(res.R)
#Instalar las librerias necesarias y cargarlas
instalar <- function(paquete) {
if (!require(paquete,character.only = TRUE,
quietly = TRUE,
warn.conflicts = FALSE)){
install.packages(as.character(paquete),
dependecies = TRUE,
repos = "http://cran.us.r-project.org")
library(paquete,
character.only = TRUE,
quietly = TRUE,
warn.conflicts = FALSE)
}
}
libs <- c( 'readr', 'R0')
lapply(libs, instalar)
data<-read.csv("prueba.csv", header=TRUE)
names(data)<-c("fecha","acumulado","individual")
head(data)
#Instalar las librerias necesarias y cargarlas
instalar <- function(paquete) {
if (!require(paquete,character.only = TRUE,
quietly = TRUE,
warn.conflicts = FALSE)){
install.packages(as.character(paquete),
dependecies = TRUE,
repos = "http://cran.us.r-project.org")
library(paquete,
character.only = TRUE,
quietly = TRUE,
warn.conflicts = FALSE)
}
}
libs <- c( 'readr', 'R0')
lapply(libs, instalar)
data<-read.csv("prueba.csv", header=TRUE)
names(data)<-c("fecha","acumulado","individual")
head(data)
data<-read.csv("prueba.csv", header=TRUE)
names(data)<-c("fecha","acumulado","individual")
head(data)
plot(acumulado~fecha,data,type='b',bty='l',
main='Brote de Covid-19 en ___',
xlab='día',ylab='Casos de Covid-19')
plot(log(acumulado)~fecha,data,type='b',log='y',bty='l',main='Gráfica semilog de datos acumulados de brote de covid-19 en ___',
xlab='día',ylab='Casos de Covid-19')
d<-15
fit <- lm(log(acumulado)~fecha,data=subset(data,fecha<=d))
#Instalar las librerias necesarias y cargarlas
instalar <- function(paquete) {
if (!require(paquete,character.only = TRUE,
quietly = TRUE,
warn.conflicts = FALSE)){
install.packages(as.character(paquete),
dependecies = TRUE,
repos = "http://cran.us.r-project.org")
library(paquete,
character.only = TRUE,
quietly = TRUE,
warn.conflicts = FALSE)
}
}
libs <- c( 'readr', 'R0')
lapply(libs, instalar)
data<-read.csv("prueba.csv", header=TRUE)
names(data)<-c("dia","acumulado","individual")
head(data)
plot(acumulado~dia,data,type='b',bty='l',
main='Brote de Covid-19 en ___',
xlab='día',ylab='Casos de Covid-19')
plot(log(acumulado)~dia,data,type='b',log='y',bty='l',main='Gráfica semilog de datos acumulados de brote de covid-19 en ___',
xlab='día',ylab='Casos de Covid-19')
d<-15
fit <- lm(log(acumulado)~dia,data=subset(data,dia<=d))
data<-read.csv("prueba.csv", header=TRUE)
names(data)<-c("dia","acumulado","individual")
head(data)
plot(acumulado~dia,data,type='b',bty='l',
main='Brote de Covid-19 en ___',
xlab='día',ylab='Casos de Covid-19')
plot(log(acumulado)~dia,data,type='b',log='y',bty='l',main='Gráfica semilog de datos acumulados de brote de covid-19 en ___',
xlab='día',ylab='Casos de Covid-19')
d<-15
fit <- lm(log(acumulado)~dia,data=subset(data,dia<=d))
summary(fit)
coef(fit)
slope <- coef(fit)[2]
slope
gamma<-1/3.95 #1/gamma es el tiempo promedio de infección que para el covid-19 es 3.95 días
m<-slope
mu<-1/(70*365) #1/mu es el tiempo promedio de vida
r0<-m/(mu+gamma)+1
r0
slope.se<-coef(summary(fit))[2,2]
slope.se
err<-2.5*slope.se
(inf<-r0-err)
(sup<-r0+err)
days<-2:30
slope<-numeric(length=length(days))
slope.se<-numeric(length=length(days))
for (k in seq_along(days)){
fit<-lm(log(acumulado)~dia, data=subset(data, dia<=days[k]))
slope[k]<-coef(summary(fit))[2,1]
slope.se[k]<-coef(summary(fit))[2,2]
R0.hat<-slope*2.5+1
R0.se<-slope.se*2.5
}
plot(slope~days,type="o")
plot(slope.se~days,type="o")
plot(range(days),
range(c(R0.hat-2*R0.se,R0.hat+2*R0.se),na.rm=T),
type='n',bty='l',
xlab="length of initial phase (da)",
ylab= expression("estimated" ~ R[0])
)
lines(R0.hat~days, type='o',lwd=2)
lines(R0.hat+2*R0.se~days,type='l')
lines(R0.hat-2*R0.se~days,type='l')
#Instalar las librerias necesarias y cargarlas
instalar <- function(paquete) {
if (!require(paquete,character.only = TRUE,
quietly = TRUE,
warn.conflicts = FALSE)){
install.packages(as.character(paquete),
dependecies = TRUE,
repos = "http://cran.us.r-project.org")
library(paquete,
character.only = TRUE,
quietly = TRUE,
warn.conflicts = FALSE)
}
}
libs <- c( 'readr', 'R0')
lapply(libs, instalar)
data<-read.csv("prueba.csv", header=TRUE)
names(data)<-c("dia","acumulado","individual")
head(data)
plot(acumulado~dia,data,type='b',bty='l',
main='Brote de Covid-19 en ___',
xlab='día',ylab='Casos de Covid-19')
plot(log(acumulado)~dia,data,type='b',log='y',bty='l',main='Gráfica semilog de datos acumulados de brote de covid-19 en ___',
xlab='día',ylab='Casos de Covid-19')
d<-15
fit <- lm(log(acumulado)~dia,data=subset(data,dia<=d))
summary(fit)
coef(fit)
pendiente <- coef(fit)[2]
pendiente
gamma<-1/3.95 #1/gamma es el tiempo promedio de infección que para el covid-19 es 3.95 días
m<-pendiente
mu<-1/(70*365) #1/mu es el tiempo promedio de vida
r0<-m/(mu+gamma)+1
r0
pendiente.se<-coef(summary(fit))[2,2]
pendiente.se
err<-2.5*pendiente.se
(inf<-r0-err)
(sup<-r0+err)
days<-2:30
pendiente<-numeric(length=length(days))
pendiente.se<-numeric(length=length(days))
for (k in seq_along(days)){
fit<-lm(log(acumulado)~dia, data=subset(data, dia<=days[k]))
pendiente[k]<-coef(summary(fit))[2,1]
pendiente.se[k]<-coef(summary(fit))[2,2]
R0.hat<-pendiente*2.5+1
R0.se<-pendiente.se*2.5
}
plot(pendiente~days,type="o")
plot(pendiente.se~days,type="o")
#Instalar las librerias necesarias y cargarlas
instalar <- function(paquete) {
if (!require(paquete,character.only = TRUE,
quietly = TRUE,
warn.conflicts = FALSE)){
install.packages(as.character(paquete),
dependecies = TRUE,
repos = "http://cran.us.r-project.org")
library(paquete,
character.only = TRUE,
quietly = TRUE,
warn.conflicts = FALSE)
}
}
libs <- c( 'readr', 'R0')
lapply(libs, instalar)
data<-read.csv("prueba.csv", header=TRUE)
names(data)<-c("dia","acumulado","individual")
head(data)
plot(acumulado~dia,data,type='b',bty='l',
main='Brote de Covid-19 en ___',
xlab='día',ylab='Casos de Covid-19')
plot(log(acumulado)~dia,data,type='b',log='y',bty='l',main='Gráfica semilog de datos acumulados de brote de covid-19 en ___',
xlab='día',ylab='Casos de Covid-19')
d<-15
fit <- lm(log(acumulado)~dia,data=subset(data,dia<=d))
summary(fit)
coef(fit)
pendiente <- coef(fit)[2]
pendiente
gamma<-1/3.95 #1/gamma es el tiempo promedio de infección que para el covid-19 es 3.95 días
m<-pendiente
mu<-1/(70*365) #1/mu es el tiempo promedio de vida
r0<-m/(mu+gamma)+1
r0
pendiente.se<-coef(summary(fit))[2,2]
pendiente.se
err<-2.5*pendiente.se
(inf<-r0-err)
(sup<-r0+err)
Dias<-2:30
pendiente<-numeric(length=length(Dias))
pendiente.se<-numeric(length=length(Dias))
for (k in seq_along(Dias)){
fit<-lm(log(acumulado)~dia, data=subset(data, dia<=Dias[k]))
pendiente[k]<-coef(summary(fit))[2,1]
pendiente.se[k]<-coef(summary(fit))[2,2]
R0.hat<-pendiente*2.5+1
R0.se<-pendiente.se*2.5
}
plot(pendiente~Dias,type="o")
plot(pendiente.se~Dias,type="o")
plot(range(Dias),
range(c(R0.hat-2*R0.se,R0.hat+2*R0.se),na.rm=T),
type='n',bty='l',
xlab="length of initial phase (da)",
ylab= expression("estimated" ~ R[0])
)
lines(R0.hat~Dias, type='o',lwd=2)
lines(R0.hat+2*R0.se~Dias,type='l')
lines(R0.hat-2*R0.se~Dias,type='l')
plot(range(Dias),
range(c(R0.hat-2*R0.se,R0.hat+2*R0.se),na.rm=T),
type='n',bty='l',
xlab="longitud inicial de la fase",
ylab= expression("estimado" ~ R[0])
)
lines(R0.hat~Dias, type='o',lwd=2)
lines(R0.hat+2*R0.se~Dias,type='l')
lines(R0.hat-2*R0.se~Dias,type='l')
epid=data$individual
GT.covid<-generation.time("weibull",c(3.95,1))
sensitivity.analysis(epid, GT.covid, begin=1,end=31, est.method="EG", sa.type="time")
res.R<-estimate.R(epid,GT=GT.covid,methods=c("EG"))
(EG<-est.R0.EG(epid,GT.covid,begin=1,end=31,nsim=1000))
plotfit(res.R)
